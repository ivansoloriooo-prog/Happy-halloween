<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1" />
<title>Happy Halloweenie</title>
<style>
  :root{
    --bg:#1b1b2f;
    --panel:#0f1724;
    --accent:#ffb347;
    --accent2:#8b5cf6;
    color: #fff;
    font-family: "Press Start 2P", monospace;
  }
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

  html,body{height:100%;margin:0;background:linear-gradient(180deg,#0b1020,#191824);display:flex;align-items:center;justify-content:center;}
  .wrap{width:100%;max-width:480px;padding:16px;box-sizing:border-box;}
  .card{background:linear-gradient(180deg,#0b1320 0%, #0b1020 100%);border-radius:12px;padding:12px;box-shadow:0 6px 24px rgba(0,0,0,.6);}
  canvas{display:block;width:100%;height:auto;background:#0f1724;border-radius:8px;image-rendering:pixelated;}
  .hud{display:flex;justify-content:space-between;align-items:center;margin-top:10px;gap:8px;}
  .btn{background:transparent;border:1px solid rgba(255,255,255,.08);padding:8px 10px;border-radius:8px;color:#fff;font-size:11px;}
  .title{font-size:12px;color:var(--accent);display:flex;gap:8px;align-items:center;}
  .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none;}
  .panel{pointer-events:auto;background:linear-gradient(180deg,rgba(0,0,0,.6),rgba(0,0,0,.8));padding:18px;border-radius:10px;text-align:center;}
  .big{font-size:13px;margin:8px 0;}
  .small{font-size:10px;color: #ccd;}
  .center{display:flex;align-items:center;justify-content:center;flex-direction:column;}
  .hidden{display:none;}
  .confetti{font-size:26px; animation:pop .8s ease;}
  @keyframes pop{0%{transform:scale(.6);opacity:0}100%{transform:scale(1);opacity:1}}
  footer{font-size:9px;color:#99a;border-top:1px dashed rgba(255,255,255,.03);padding-top:8px;margin-top:10px}
  a{color:var(--accent2);text-decoration:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="app">
    <div style="position:relative">
      <canvas id="game" width="320" height="352"></canvas>
      <div class="overlay" id="overlay" style="pointer-events:auto;">
        <div class="panel center" id="startPanel">
          <div style="font-size:14px;color:var(--accent)">üéÉ Cute Corn Maze</div>
          <div class="small" style="margin:6px 0">Swipe to move ‚Ä¢ Retro pixel art ‚Ä¢ All ages</div>
          <button class="btn" id="startBtn">Tap to Start (Play Music)</button>
          <div class="small" style="margin-top:8px">Music: add a legal ‚ÄúSpooky Scary Skeletons‚Äù mp3 URL in the code.</div>
        </div>

        <div class="panel center hidden" id="winPanel">
          <div class="confetti">‚ú® You escaped the maze! ‚ú®</div>
          <div class="big">Text 408-569-3271 for a Treat üç¨</div>
          <button class="btn" id="replayBtn" style="margin-top:8px">Play Again</button>
        </div>
      </div>
    </div>

    <div class="hud">
      <div class="title">üëª Retro Corn Maze</div>
      <div>
        <button class="btn" id="muteBtn">üîä Music</button>
        <button class="btn" id="helpBtn">‚ùì Help</button>
      </div>
    </div>

    <footer>
      Controls: Swipe on mobile or use arrow keys. Host the file and create a QR code linking to the page.
    </footer>
  </div>
</div>

<!-- Audio: replace the src value with a link to a legal mp3/ogg of "Spooky Scary Skeletons" or a chiptune cover -->
<audio id="bgm" loop preload="auto" src="https://files.freemusicarchive.org/storage-freemusicarchive-org/music/no_curator/Komiku/Its_time_for_adventure/Komiku_-_12_-_Ghost_Chiptune.mp3"></audio>


<script>
/* ======= Config ======= */
const CELL = 16;
const COLS = 20;
const ROWS = 22;
// 0 = path, 1 = wall, 2 = start, 3 = exit, 4 = candy
const MAZE = [
[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
[1,2,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,4,1],
[1,0,1,1,0,1,0,1,1,1,0,1,0,1,1,0,1,0,0,1],
[1,0,1,1,0,0,0,1,0,0,0,0,0,1,1,0,0,1,0,1],
[1,0,0,0,0,1,0,1,0,1,1,1,0,0,0,1,0,1,0,1],
[1,1,1,1,0,1,0,1,0,0,0,1,1,1,0,1,0,1,0,1],
[1,0,0,1,0,0,0,1,1,1,0,0,0,1,0,0,0,1,0,1],
[1,0,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1],
[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
[1,1,1,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],
[1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,1],
[1,0,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1],
[1,0,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1],
[1,0,1,0,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1],
[1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1],
[1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,0,1,0,1],
[1,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,1],
[1,0,1,1,1,1,1,1,0,1,1,1,0,1,1,1,0,1,0,1],
[1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1],
[1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,0,1],
[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,1],
[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
];

let canvas = document.getElementById('game');
let ctx = canvas.getContext('2d');
function fitCanvas() {
  const maxWidth = Math.min(window.innerWidth - 48, 480);
  const ratio = canvas.width / canvas.height;
  canvas.style.width = maxWidth + 'px';
  canvas.style.height = Math.floor(maxWidth / ratio) + 'px';
}
window.addEventListener('resize', fitCanvas);
fitCanvas();

let player = {x:0,y:0,px:0,py:0,anim:0};
let started = false;
let won = false;
let bgm = document.getElementById('bgm');
const startPanel = document.getElementById('startPanel');
const winPanel = document.getElementById('winPanel');
for(let r=0;r<22;r++){for(let c=0;c<20;c++){if(MAZE[r][c]===2){player.x=c;player.y=r;player.px=c;player.py=r;}}}

function draw(){
  ctx.fillStyle='#0b1020';ctx.fillRect(0,0,320,352);
  for(let r=0;r<22;r++){for(let c=0;c<20;c++){
    let v=MAZE[r][c];let x=c*16,y=r*16;
    if(v===1){ctx.fillStyle='#1b5e1a';ctx.fillRect(x,y,16,16);}
    else{ctx.fillStyle='#2b2416';ctx.fillRect(x,y,16,16);}
    if(v===4){ctx.fillStyle='#ff6b6b';ctx.fillRect(x+4,y+4,8,8);}
    if(v===3){ctx.fillStyle='#9fb7ff';ctx.fillRect(x+2,y+2,12,12);}
  }}
  let px=(player.px+(player.x-player.px)*player.anim)*16;
  let py=(player.py+(player.y-player.py)*player.anim)*16;
  ctx.fillStyle='#ff9e40';
  ctx.fillRect(px+2,py+2,12,12);
  ctx.fillStyle='#160b00';
  ctx.fillRect(px+5,py+5,2,2);
  ctx.fillRect(px+9,py+5,2,2);
}

function canMove(nx,ny){return !(nx<0||ny<0||nx>=20||ny>=22||MAZE[ny][nx]===1);}
function move(dx,dy){
  if(!started||player.anim>0.01||won)return;
  let nx=player.x+dx,ny=player.y+dy;
  if(canMove(nx,ny)){
    player.px=player.x;player.py=player.y;player.x=nx;player.y=ny;player.anim=0;
    if(MAZE[ny][nx]===3)setTimeout(()=>win(),350);
  }
}

let ts=null,tx=null,ty=null;
canvas.addEventListener('touchstart',e=>{const t=e.changedTouches[0];ts=Date.now();tx=t.clientX;ty=t.clientY;},{passive:true});
canvas.addEventListener('touchend',e=>{
  const t=e.changedTouches[0];if(!ts)return;
  const dx=t.clientX-tx;const dy=t.clientY-ty;
  if(Math.abs(dx)>Math.abs(dy)&&Math.abs(dx)>20){dx>0?move(1,0):move(-1,0);}
  else if(Math.abs(dy)>20){dy>0?move(0,1):move(0,-1);}
  ts=null;
},{passive:true});

window.addEventListener('keydown',e=>{
  if(!started)return;
  if(e.key==='ArrowUp')move(0,-1);
  if(e.key==='ArrowDown')move(0,1);
  if(e.key==='ArrowLeft')move(-1,0);
  if(e.key==='ArrowRight')move(1,0);
});

function step(){if(player.anim<1){player.anim+=0.2;if(player.anim>1)player.anim=1;}else{player.px=player.x;player.py=player.y;}draw();requestAnimationFrame(step);}requestAnimationFrame(step);

document.getElementById('startBtn').addEventListener('click',()=>startGame());
document.getElementById('replayBtn').addEventListener('click',()=>restart());
document.getElementById('muteBtn').addEventListener('click',()=>{
  if(bgm.src&&!bgm.paused){bgm.pause();document.getElementById('muteBtn').textContent='üîá Music';}
  else if(bgm.src){bgm.play();document.getElementById('muteBtn').textContent='üîä Music';}
  else alert('No music URL set. Add one in the HTML source.');
});
document.getElementById('helpBtn').addEventListener('click',()=>alert('Swipe to move on mobile. Arrow keys on desktop. Find the candy bucket!'));

function startGame(){
  if(bgm.src)bgm.play().catch(()=>{});
  started=true;startPanel.classList.add('hidden');winPanel.classList.add('hidden');
  document.getElementById('overlay').style.pointerEvents='none';
}
function win(){won=true;bgm.pause();document.getElementById('overlay').style.pointerEvents='auto';winPanel.classList.remove('hidden');}
function restart(){
  for(let r=0;r<22;r++){for(let c=0;c<20;c++){if(MAZE[r][c]===2){player.x=c;player.y=r;player.px=c;player.py=r;player.anim=1;}}}
  started=false;won=false;startPanel.classList.remove('hidden');winPanel.classList.add('hidden');
  document.getElementById('overlay').style.pointerEvents='auto';
}
</script>
</body>
</html>
